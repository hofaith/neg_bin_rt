############################
quartz()
par(mar=c(3,3,1,1),xpd=T,mfrow=c(2,4))
plot(NA,xlim=c(0,70),ylim=c(0,4),xlab="",ylab="",axes=F,main="")
axis(1, at=0:70, labels=NA, las=1,line=-0.2,tck=-0.01)
mtext(10*0:7, side=1, at=10*0:7, line=-0.2, cex=0.5,las=0)
axis(2,at=0:4,labels=NA,tck=-0.01,line=-0.5)
mtext(0:4,side=2,at=0:4,las=1,cex=0.5,line=-0.1)
for (i in 1:50) {
  lines(10:70,get(paste0("sim3.pois.rt.ci.l",i))[10:70],col=alpha("dark blue",0.2))
  lines(10:70,get(paste0("sim3.pois.rt.ci.u",i))[10:70],col=alpha("dark blue",0.2))
  lines(10:70,get(paste0("sim3.pois.rt",i))[10:70],col=alpha("black",0.2))
}
lines(10:70,rowMeans(mapply(c,mget(paste0("sim3.pois.rt",1:50))))[10:70],lwd=1.5,col="limegreen")
lines(c(10:70),rep(1.2,70-9),col="red")
text(-8,4.3,"A",font=2)
text(38,4.3,"k = 0.2",font=2,cex=1.2)
text(72,3.95,"Mean WAIC = 771.3",font=2,cex=0.8,pos=2)
mtext(side=2,"Effective reproductive number \nunder Poisson distribution",cex=0.6,las=0,line=0.5)

par(mar=c(3,3,1,1),xpd=T)
plot(NA,xlim=c(0,70),ylim=c(0,4),xlab="",ylab="",axes=F,main="")
axis(1, at=0:70, labels=NA, las=1,line=-0.2,tck=-0.01)
mtext(10*0:7, side=1, at=10*0:7, line=-0.2, cex=0.5,las=0)
axis(2,at=0:4,labels=NA,tck=-0.01,line=-0.5)
mtext(0:4,side=2,at=0:4,las=1,cex=0.5,line=-0.1)
for (i in 1:50) {
  lines(10:70,get(paste0("sim4.pois.rt.ci.l",i))[10:70],col=alpha("dark blue",0.2))
  lines(10:70,get(paste0("sim4.pois.rt.ci.u",i))[10:70],col=alpha("dark blue",0.2))
  lines(10:70,get(paste0("sim4.pois.rt",i))[10:70],col=alpha("black",0.2))
}
lines(10:70,rowMeans(mapply(c,mget(paste0("sim4.pois.rt",1:50))))[10:70],lwd=1.5,col="limegreen")
lines(c(10:70),rep(1.2,70-9),col="red")
text(-8,4.3,"B",font=2)
text(38,4.3,"k = 0.5",font=2,cex=1.2)
text(72,3.95,"Mean WAIC = 578.5",font=2,cex=0.8,pos=2)

par(mar=c(3,3,1,1),xpd=T)
plot(NA,xlim=c(0,70),ylim=c(0,4),xlab="",ylab="",axes=F,main="")
axis(1, at=0:70, labels=NA, las=1,line=-0.2,tck=-0.01)
mtext(10*0:7, side=1, at=10*0:7, line=-0.2, cex=0.5,las=0)
axis(2,at=0:4,labels=NA,tck=-0.01,line=-0.5)
mtext(0:4,side=2,at=0:4,las=1,cex=0.5,line=-0.1)
for (i in 1:50) {
  lines(10:70,get(paste0("sim5.pois.rt.ci.l",i))[10:70],col=alpha("dark blue",0.2))
  lines(10:70,get(paste0("sim5.pois.rt.ci.u",i))[10:70],col=alpha("dark blue",0.2))
  lines(10:70,get(paste0("sim5.pois.rt",i))[10:70],col=alpha("black",0.2))
}
lines(10:70,rowMeans(mapply(c,mget(paste0("sim5.pois.rt",1:50))))[10:70],lwd=1.5,col="limegreen")
lines(c(10:70),rep(1.2,70-9),col="red")
text(-8,4.3,"C",font=2)
text(38,4.3,"k = 1",font=2,cex=1.2)
text(72,3.95,"Mean WAIC = 529.1",font=2,cex=0.8,pos=2)

par(mar=c(3,3,1,1),xpd=T)
plot(NA,xlim=c(0,70),ylim=c(0,4),xlab="",ylab="",axes=F,main="")
axis(1, at=0:70, labels=NA, las=1,line=-0.2,tck=-0.01)
mtext(10*0:7, side=1, at=10*0:7, line=-0.2, cex=0.5,las=0)
axis(2,at=0:4,labels=NA,tck=-0.01,line=-0.5)
mtext(0:4,side=2,at=0:4,las=1,cex=0.5,line=-0.1)
for (i in 1:50) {
  lines(10:70,get(paste0("sim6.pois.rt.ci.l",i))[10:70],col=alpha("dark blue",0.2))
  lines(10:70,get(paste0("sim6.pois.rt.ci.u",i))[10:70],col=alpha("dark blue",0.2))
  lines(10:70,get(paste0("sim6.pois.rt",i))[10:70],col=alpha("black",0.2))
}
lines(10:70,rowMeans(mapply(c,mget(paste0("sim6.pois.rt",1:50))))[10:70],lwd=1.5,col="limegreen")
lines(c(10:70),rep(1.2,70-9),col="red")
text(-8,4.3,"D",font=2)
text(38,4.3,"k = 10",font=2,cex=1.2)
text(72,3.95,"Mean WAIC = 453.4",font=2,cex=0.8,pos=2)

par(mar=c(3,3,1,1),xpd=T)
plot(NA,xlim=c(0,70),ylim=c(0,4),xlab="",ylab="",axes=F,main="")
axis(1, at=0:70, labels=NA, las=1,line=-0.2,tck=-0.01)
mtext(10*0:7, side=1, at=10*0:7, line=-0.2, cex=0.5,las=0)
axis(2,at=0:4,labels=NA,tck=-0.01,line=-0.5)
mtext(0:4,side=2,at=0:4,las=1,cex=0.5,line=-0.1)
for (i in 1:50) {
  lines(10:70,get(paste0("sim3.rt.ci.l",i))[10:70],col=alpha("dark blue",0.2))
  lines(10:70,get(paste0("sim3.rt.ci.u",i))[10:70],col=alpha("dark blue",0.2))
  lines(10:70,get(paste0("sim3.rt",i))[10:70],col=alpha("black",0.2))
}
lines(10:70,rowMeans(mapply(c,mget(paste0("sim3.rt",1:50))))[10:70],lwd=1.5,col="limegreen")
lines(c(10:70),rep(1.2,70-9),col="red")
text(-8,4.3,"E",font=2)
text(72,3.95,"Mean WAIC = 534.0\nMean WAIC diff. = 237.2",font=2,cex=0.8,pos=2)
mtext(side=2,"Effective reproductive number \nunder negative binomial distribution",cex=0.6,las=0,line=0.5)
mtext(side=1,line=1.9,"Days since epidemic",cex=0.8)

par(mar=c(3,3,1,1),xpd=T)
plot(NA,xlim=c(0,70),ylim=c(0,4),xlab="",ylab="",axes=F,main="")
axis(1, at=0:70, labels=NA, las=1,line=-0.2,tck=-0.01)
axis(2,at=0:4,labels=NA,tck=-0.01,line=-0.5)
mtext(0:4,side=2,at=0:4,las=1,cex=0.5,line=-0.1)
for (i in 1:50) {
  lines(10:70,get(paste0("sim4.rt.ci.l",i))[10:70],col=alpha("dark blue",0.2))
  lines(10:70,get(paste0("sim4.rt.ci.u",i))[10:70],col=alpha("dark blue",0.2))
  lines(10:70,get(paste0("sim4.rt",i))[10:70],col=alpha("black",0.2))
}
lines(10:70,rowMeans(mapply(c,mget(paste0("sim4.rt",1:50))))[10:70],lwd=1.5,col="limegreen")
mtext(10*0:7, side=1, at=10*0:7, line=-0.2, cex=0.5,las=0)
lines(c(10:70),rep(1.2,70-9),col="red")
mtext(side=1,line=1.9,"Days since epidemic",cex=0.8)
text(72,3.95,"Mean WAIC = 510.5\nMean WAIC diff. = 68.0",font=2,cex=0.8,pos=2)
text(-8,4.3,"F",font=2)

par(mar=c(3,3,1,1),xpd=T)
plot(NA,xlim=c(0,70),ylim=c(0,4),xlab="",ylab="",axes=F,main="")
axis(1, at=0:70, labels=NA, las=1,line=-0.2,tck=-0.01)
axis(2,at=0:4,labels=NA,tck=-0.01,line=-0.5)
mtext(0:4,side=2,at=0:4,las=1,cex=0.5,line=-0.1)
for (i in 1:50) {
  lines(10:70,get(paste0("sim5.rt.ci.l",i))[10:70],col=alpha("dark blue",0.2))
  lines(10:70,get(paste0("sim5.rt.ci.u",i))[10:70],col=alpha("dark blue",0.2))
  lines(10:70,get(paste0("sim5.rt",i))[10:70],col=alpha("black",0.2))
}
lines(10:70,rowMeans(mapply(c,mget(paste0("sim5.rt",1:50))))[10:70],lwd=1.5,col="limegreen")
mtext(10*0:7, side=1, at=10*0:7, line=-0.2, cex=0.5,las=0)
lines(c(10:70),rep(1.2,70-9),col="red")
mtext(side=1,line=1.9,"Days since epidemic",cex=0.8)
text(72,3.95,"Mean WAIC = 506.6\nMean WAIC diff. = 22.5",font=2,cex=0.8,pos=2)
text(-8,4.3,"G",font=2)

par(mar=c(3,3,1,1),xpd=T)
plot(NA,xlim=c(0,70),ylim=c(0,4),xlab="",ylab="",axes=F,main="")
axis(1, at=0:70, labels=NA, las=1,line=-0.2,tck=-0.01)
axis(2,at=0:4,labels=NA,tck=-0.01,line=-0.5)
mtext(0:4,side=2,at=0:4,las=1,cex=0.5,line=-0.1)
for (i in 1:50) {
  lines(10:70,get(paste0("sim6.rt.ci.l",i))[10:70],col=alpha("dark blue",0.2))
  lines(10:70,get(paste0("sim6.rt.ci.u",i))[10:70],col=alpha("dark blue",0.2))
  lines(10:70,get(paste0("sim6.rt",i))[10:70],col=alpha("black",0.2))
}
lines(10:70,rowMeans(mapply(c,mget(paste0("sim6.rt",1:50))))[10:70],lwd=1.5,col="limegreen")
mtext(10*0:7, side=1, at=10*0:7, line=-0.2, cex=0.5,las=0)
lines(c(10:70),rep(1.2,70-9),col="red")
mtext(side=1,line=1.9,"Days since epidemic",cex=0.8)
text(72,3.95,"Mean WAIC = 463.9\nMean WAIC diff. = -10.5",font=2,cex=0.8,pos=2)
text(-8,4.3,"H",font=2)

###########################################################################
